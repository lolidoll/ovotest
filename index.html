<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#ffffff">
    <link rel="apple-touch-icon" href="https://i.postimg.cc/5t8d45Lh/IMG-20260116-212844.png">
    <title>薯片机</title>
    <link rel="stylesheet" href="style.css">
    <script src="app.js" defer></script>
  
</head>
<body>
    <!-- 消息通知栏 -->
    <div class="notification-bar" id="notification-bar">
        <div class="notification-content">
            <div class="notification-left">
                <div class="notification-avatar" id="notification-avatar">通</div>
                <div class="notification-info">
                    <div class="notification-name" id="notification-name">通知名称</div>
                    <div class="notification-preview" id="notification-preview">通知内容预览</div>
                </div>
            </div>
            <div class="notification-right">
                <div class="notification-time" id="notification-time">时间</div>
                <div class="notification-close" id="notification-close">×</div>
            </div>
        </div>
    </div>
    
    <div id="app-container">
        <!-- 顶部导航栏 -->
        <div class="top-nav" id="top-nav">
            <div class="user-info" id="user-info">
                <div class="user-avatar" id="user-avatar-display">薯</div>
                <div class="user-name">薯片机用户</div>
            </div>
            <div class="add-btn" id="add-btn">
                <svg class="icon-svg" viewBox="0 0 24 24">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
            </div>
        </div>

        <!-- 添加弹窗 -->
        <div class="add-popup" id="add-popup">
            <div class="popup-item" id="add-friend-btn">
                <div class="popup-icon">
                    <svg class="icon-svg" viewBox="0 0 24 24">
                        <circle cx="10" cy="8" r="4"></circle>
                        <path d="M2 20c0-4 4-6 8-6"></path>
                        <line x1="19" y1="11" x2="19" y2="17"></line>
                        <line x1="16" y1="14" x2="22" y2="14"></line>
                    </svg>
                </div>
                <div class="popup-text">添加好友</div>
            </div>
            <div class="popup-divider"></div>
            <div class="popup-item" id="create-group-btn">
                <div class="popup-icon">
                    <svg class="icon-svg" viewBox="0 0 24 24">
                        <circle cx="9" cy="7" r="3"></circle>
                        <circle cx="15" cy="7" r="3"></circle>
                        <path d="M3 19c0-3 3-5 6-5"></path>
                        <path d="M15 14c3 0 6 2 6 5"></path>
                        <line x1="12" y1="17" x2="12" y2="21"></line>
                        <line x1="10" y1="19" x2="14" y2="19"></line>
                    </svg>
                </div>
                <div class="popup-text">创建群聊</div>
            </div>
            <div class="popup-divider"></div>
            <div class="popup-item" id="import-card-btn">
                <div class="popup-icon">
                    <svg class="icon-svg" viewBox="0 0 24 24">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                </div>
                <div class="popup-text">导入角色卡</div>
            </div>
        </div>

        <!-- 侧边功能栏 -->
        <div class="side-menu" id="side-menu">
            <div class="card-info" id="card-info">
                <div class="card-bg" id="card-bg"></div>
                <div class="card-content">
                    <div class="card-avatar" id="card-avatar">薯</div>
                    <div class="card-name" id="display-name">薯片机用户</div>
                    <div class="card-signature" id="card-signature">这个人很懒，什么都没写~</div>
                </div>
            </div>
            
            <div class="menu-list">
                <div class="menu-item" data-func="wallet">
                    <div class="menu-icon">
                        <svg class="icon-svg" viewBox="0 0 24 24">
                            <rect x="2" y="6" width="20" height="14" rx="2"></rect>
                            <path d="M2 10h20"></path>
                            <circle cx="16" cy="14" r="1.5"></circle>
                        </svg>
                    </div>
                    <div class="menu-text">钱包</div>
                </div>
                
                <div class="menu-item" data-func="collection">
                    <div class="menu-icon">
                        <svg class="icon-svg" viewBox="0 0 24 24">
                            <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
                        </svg>
                    </div>
                    <div class="menu-text">收藏</div>
                </div>
                
                <div class="menu-item" data-func="emoji">
                    <div class="menu-icon">
                        <svg class="icon-svg" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
                            <line x1="9" y1="9" x2="9.01" y2="9"></line>
                            <line x1="15" y1="9" x2="15.01" y2="9"></line>
                        </svg>
                    </div>
                    <div class="menu-text">表情包</div>
                </div>
                
                <div class="menu-item" data-func="worldbook">
                    <div class="menu-icon">
                        <svg class="icon-svg" viewBox="0 0 24 24">
                            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                            <circle cx="12" cy="10" r="3"></circle>
                            <path d="M12 13v2"></path>
                        </svg>
                    </div>
                    <div class="menu-text">世界书</div>
                </div>
                
                <div class="menu-divider"></div>
                
                <div class="menu-item" data-func="decoration">
                    <div class="menu-icon">
                        <svg class="icon-svg" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path d="M12 2v4"></path>
                            <path d="M12 18v4"></path>
                            <path d="M4.93 4.93l2.83 2.83"></path>
                            <path d="M16.24 16.24l2.83 2.83"></path>
                            <path d="M2 12h4"></path>
                            <path d="M18 12h4"></path>
                            <path d="M4.93 19.07l2.83-2.83"></path>
                            <path d="M16.24 7.76l2.83-2.83"></path>
                        </svg>
                    </div>
                    <div class="menu-text">个性装扮</div>
                </div>
                
                <div class="menu-item" data-func="api-settings">
                    <div class="menu-icon">
                        <svg class="icon-svg" viewBox="0 0 24 24">
                            <rect x="3" y="3" width="7" height="7" rx="1"></rect>
                            <rect x="14" y="3" width="7" height="7" rx="1"></rect>
                            <rect x="3" y="14" width="7" height="7" rx="1"></rect>
                            <circle cx="17.5" cy="17.5" r="3.5"></circle>
                        </svg>
                    </div>
                    <div class="menu-text">API设置</div>
                </div>
                
                <div class="menu-item" data-func="couples-space">
                    <div class="menu-icon">
                        <svg class="icon-svg" viewBox="0 0 24 24">
                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                        </svg>
                    </div>
                    <div class="menu-text">情侣空间</div>
                </div>
                
                <div class="menu-divider"></div>
                
                <div class="menu-item" data-func="preset">
                    <div class="menu-icon">
                        <svg class="icon-svg" viewBox="0 0 24 24">
                            <rect x="3" y="3" width="7" height="7" rx="1"></rect>
                            <rect x="14" y="3" width="7" height="7" rx="1"></rect>
                            <rect x="3" y="14" width="7" height="7" rx="1"></rect>
                            <rect x="14" y="14" width="7" height="7" rx="1"></rect>
                        </svg>
                    </div>
                    <div class="menu-text">配置</div>
                </div>
                
                <div class="menu-item" data-func="settings">
                    <div class="menu-icon">
                        <svg class="icon-svg" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33h.09a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82v.09a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                        </svg>
                    </div>
                    <div class="menu-text">设置</div>
                </div>
            </div>
        </div>

        <!-- 遮罩层 -->
        <div class="mask" id="mask"></div>

        <!-- 消息页面 -->
        <div class="main-content msg-page active" id="msg-page">
            <div class="search-bar">
                <div class="search-wrapper">
                    <svg class="icon-svg search-icon" viewBox="0 0 24 24">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                    <input type="text" class="search-input" placeholder="搜索" id="search-input-msg">
                </div>
            </div>
            
            <div class="msg-list" id="msg-list">
                <div class="empty-state" id="msg-empty">
                    <div class="empty-icon">
                        <svg class="icon-svg" viewBox="0 0 24 24" style="width:100%;height:100%;">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2  2 0 0 1 2 2z"></path>
                            <line x1="9" y1="10" x2="15" y2="10"></line>
                        </svg>
                    </div>
                    <div class="empty-text">暂无消息<br>点击右上角添加好友开始聊天</div>
                </div>
            </div>
        </div>

        <!-- 好友页面 -->
        <div class="main-content friend-page" id="friend-page">
            <div class="search-bar">
                <div class="search-wrapper">
                    <svg class="icon-svg search-icon" viewBox="0 0 24 24">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                    <input type="text" class="search-input" placeholder="搜索好友" id="search-input-friend">
                </div>
            </div>
            
            <div class="friend-content" id="friend-content">
                <div class="friend-group">
                    <div class="group-header" data-group="common">
                        <div class="group-title-left">
                            <div class="group-arrow"></div>
                            <div class="group-title">我的好友</div>
                            <div class="group-count">(0/0)</div>
                        </div>
                        <div class="group-edit">管理</div>
                    </div>
                    <div class="friend-list show" data-group="common">
                        <div class="empty-state" style="padding: 30px 20px;">
                            <div class="empty-text">暂无好友</div>
                        </div>
                    </div>
                </div>
                
                <div class="friend-group">
                    <div class="group-header collapsed" data-group="groups">
                        <div class="group-title-left">
                            <div class="group-arrow"></div>
                            <div class="group-title">群聊管理</div>
                            <div class="group-count">(0/0)</div>
                        </div>
                        <div class="group-edit">管理</div>
                    </div>
                    <div class="friend-list" data-group="groups">
                        <div class="empty-state" style="padding: 30px 20px;">
                            <div class="empty-text">暂无群聊</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 动态页面 - 无顶部栏和搜索栏 -->
        <div class="main-content dynamic-page" id="dynamic-page">
            <div class="dynamic-content">
                <div class="func-list" id="func-list">
                    <!-- 朋友圈 -->
                    <div class="func-item" data-page="moments-page" data-func-id="moments">
                        <div class="func-left">
                            <div class="func-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <rect x="3" y="3" width="18" height="18" rx="2"></rect>
                                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                    <path d="M21 15l-5-5L5 21"></path>
                                </svg>
                            </div>
                            <div class="func-name">朋友圈</div>
                        </div>
                        <div class="func-arrow"></div>
                    </div>
                    
                    <!-- 论坛 -->
                    <div class="func-item" data-page="forum-page" data-func-id="forum">
                        <div class="func-left">
                            <div class="func-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                                    <line x1="8" y1="8" x2="16" y2="8"></line>
                                    <line x1="8" y1="12" x2="14" y2="12"></line>
                                </svg>
                            </div>
                            <div class="func-name">论坛</div>
                        </div>
                        <div class="func-arrow"></div>
                    </div>

                                        <!-- 阅读 -->
                    <div class="func-item" data-page="reading-page" data-func-id="reading">
                        <div class="func-left">
                            <div class="func-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                                    <line x1="8" y1="7" x2="16" y2="7"></line>
                                    <line x1="8" y1="11" x2="14" y2="11"></line>
                                </svg>
                            </div>
                            <div class="func-name">阅读</div>
                        </div>
                        <div class="func-arrow"></div>
                    </div>

                    <div class="func-divider"></div>

                    <!-- 天气 - 新添加的 -->
<div class="func-item" data-page="weather-page" data-func-id="weather">
    <div class="func-left">
        <div class="func-icon">
            <svg class="icon-svg" viewBox="0 0 24 24" fill="gray">
                <circle cx="12" cy="12" r="5"/>
                <line x1="12" y1="3" x2="12" y2="6"/>
                <line x1="12" y1="18" x2="12" y2="21"/>
                <line x1="3" y1="12" x2="6" y2="12"/>
                <line x1="18" y1="12" x2="21" y2="12"/>
                <line x1="4.22" y1="19.78" x2="6.64" y2="17.36"/>
                <line x1="17.36" y1="6.64" x2="19.78" y2="4.22"/>
                <line x1="4.22" y1="4.22" x2="6.64" y2="6.64"/>
                <line x1="17.36" y1="17.36" x2="19.78" y2="19.78"/>
            </svg>
        </div>
        <div class="func-name">天气</div>
    </div>
    <div class="func-arrow"></div>
</div>

                    <!-- 日历 -->
                    <div class="func-item" data-page="calendar-page" data-func-id="calendar">
                        <div class="func-left">
                            <div class="func-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <rect x="3" y="4" width="18" height="18" rx="2"></rect>
                                    <line x1="16" y1="2" x2="16" y2="6"></line>
                                    <line x1="8" y1="2" x2="8" y2="6"></line>
                                    <line x1="3" y1="10" x2="21" y2="10"></line>
                                </svg>
                            </div>
                            <div class="func-name">日历</div>
                        </div>
                        <div class="func-arrow"></div>
                    </div>
                    
                    <div class="func-divider"></div>
                    
                    
    <!-- 购物 - 新添加的 -->
<div class="func-item" data-page="shopping-page" data-func-id="shopping">
        <div class="func-left">
            <div class="func-icon">
                <svg class="icon-svg" viewBox="0 0 24 24">
                    <circle cx="9" cy="21" r="1"></circle>
                    <circle cx="20" cy="21" r="1"></circle>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                </svg>
            </div>
            <div class="func-name">购物</div>
        </div>
        <div class="func-arrow"></div>
    </div>

                    <!-- 游戏中心 -->
                    <div class="func-item" data-page="game-page" data-func-id="game">
                        <div class="func-left">
                            <div class="func-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <rect x="2" y="6" width="20" height="12" rx="2"></rect>
                                    <circle cx="6" cy="12" r="1.5"></circle>
                                    <circle cx="10" cy="12" r="1.5"></circle>
                                    <path d="M15 10v4"></path>
                                    <path d="M13 12h4"></path>
                                </svg>
                            </div>
                            <div class="func-name">游戏中心</div>
                        </div>
                        <div class="func-arrow"></div>
                    </div>

                    <div class="func-divider"></div>

                    <!-- 默契大挑战 -->
                    <div class="func-item" data-page="tacit-page" data-func-id="tacit">
                        <div class="func-left">
                            <div class="func-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                                </svg>
                            </div>
                            <div class="func-name">默契大挑战</div>
                        </div>
                        <div class="func-arrow"></div>
                    </div>

                    <!-- 心灵星系 -->
                    <div class="func-item" data-page="spirit-galaxy-page" data-func-id="spiritGalaxy">
                        <div class="func-left">
                            <div class="func-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <polygon points="12 2 15.09 10.26 23.77 10.26 17.39 16.01 20.48 24.27 12 18.46 3.52 24.27 6.61 16.01 0.23 10.26 8.91 10.26"></polygon>
                                </svg>
                            </div>
                            <div class="func-name">心灵星系</div>
                        </div>
                        <div class="func-arrow"></div>
                    </div>

                    <!-- 灵感库 -->
                    <div class="func-item" data-page="idea-library-page" data-func-id="ideaLibrary">
                        <div class="func-left">
                            <div class="func-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8.5 8.5z"></path>
                                    <line x1="12" y1="7" x2="12" y2="13"></line>
                                    <line x1="9" y1="10" x2="15" y2="10"></line>
                                </svg>
                            </div>
                            <div class="func-name">灵感库</div>
                        </div>
                        <div class="func-arrow"></div>
                    </div>

                    <!-- 观察者 -->
                    <div class="func-item" data-page="third-party-page" data-func-id="thirdParty">
                        <div class="func-left">
                            <div class="func-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <circle cx="12" cy="12" r="3"></circle>
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                </svg>
                            </div>
                            <div class="func-name">观察者</div>
                        </div>
                        <div class="func-arrow"></div>
                    </div>
                    
                    
                    <div class="func-divider"></div>

                </div>
                


                <!-- 更多功能按钮 -->
                <div class="more-func-item" id="more-func-btn">
                    <div class="more-func-text">更多功能 ›</div>
                </div>
            </div>
        </div>

        <!-- 底部标签栏 -->
        <div class="tab-bar" id="tab-bar">
            <div class="tab-item active" data-tab="msg-page">
                <div class="tab-icon">
                    <svg class="icon-svg" viewBox="0 0 24 24">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                </div>
                <div class="tab-text">消息</div>
            </div>
            <div class="tab-item" data-tab="friend-page">
                <div class="tab-icon">
                    <svg class="icon-svg" viewBox="0 0 24 24">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                </div>
                <div class="tab-text">好友</div>
            </div>
            <div class="tab-item" data-tab="dynamic-page">
                <div class="tab-icon">
                    <svg class="icon-svg" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 6v6l4 2"></path>
                    </svg>
                </div>
                <div class="tab-text">动态</div>
            </div>
        </div>

        <!-- 添加好友页面 -->
        <div class="add-friend-page" id="add-friend-page">
            <div class="sub-nav">
                <div class="back-btn" id="add-friend-back-btn">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">添加好友</div>
            </div>
            <div class="add-page-content">
                <div class="add-section">
                    <div class="add-section-header">基本信息</div>
                    <div class="add-input-group">
                        <label class="add-input-label">名称 *</label>
                        <input type="text" class="add-input" id="friend-name-input" placeholder="输入好友名称">
                    </div>
                    <div class="add-input-group">
                        <label class="add-input-label">头像URL（可选）</label>
                        <input type="text" class="add-input" id="friend-avatar-input" placeholder="输入头像图片链接">
                    </div>
                    <div class="add-input-group">
                        <label class="add-input-label">人设描述（可选）</label>
                        <textarea class="add-textarea" id="friend-desc-input" placeholder="描述TA的性格、背景等..."></textarea>
                    </div>
                    <div class="add-input-group">
                        <label class="add-input-label">开场白（可选）</label>
                        <textarea class="add-textarea" id="friend-greeting-input" placeholder="TA第一次说的话..."></textarea>
                    </div>
                </div>
                
                <div class="add-btn-group">
                    <button class="add-cancel-btn" id="add-friend-cancel">取消</button>
                    <button class="add-submit-btn" id="add-friend-submit">添加好友</button>
                </div>
            </div>
        </div>

        <!-- 创建群聊页面 -->
        <div class="add-friend-page" id="create-group-page">
            <div class="sub-nav">
                <div class="back-btn" id="create-group-back-btn">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">创建群聊</div>
            </div>
            <div class="add-page-content">
                <div class="add-section">
                    <div class="add-section-header">群聊信息</div>
                    <div class="add-input-group">
                        <label class="add-input-label">群名称 *</label>
                        <input type="text" class="add-input" id="group-name-input" placeholder="输入群聊名称">
                    </div>
                    <div class="add-input-group">
                        <label class="add-input-label">群头像URL（可选）</label>
                        <input type="text" class="add-input" id="group-avatar-input" placeholder="输入群头像图片链接">
                    </div>
                    <div class="add-input-group">
                        <label class="add-input-label">群描述（可选）</label>
                        <textarea class="add-textarea" id="group-desc-input" placeholder="描述群聊的主题..."></textarea>
                    </div>
                </div>
                
                <div class="add-btn-group">
                    <button class="add-cancel-btn" id="create-group-cancel">取消</button>
                    <button class="add-submit-btn" id="create-group-submit">创建群聊</button>
                </div>
            </div>
        </div>

        <!-- 导入角色卡页面 -->
        <div class="add-friend-page" id="import-card-page">
            <div class="sub-nav">
                <div class="back-btn" id="import-card-back-btn">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">导入角色卡</div>
            </div>
            <div class="add-page-content">
                <div class="import-section">
                    <div class="import-title">
                        <svg class="icon-svg" viewBox="0 0 24 24" style="width:20px;height:20px;">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                        </svg>
                        批量导入角色卡
                    </div>
                    <div class="import-desc">
                        支持 SillyTavern 格式的 JSON 角色卡文件，可一次选择多个文件批量导入。
                    </div>
                    <div class="import-btn" id="import-file-btn">
                        <svg class="icon-svg" viewBox="0 0 24 24" style="width:20px;height:20px;">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                        点击选择文件
                    </div>
                    <input type="file" class="import-file-input" id="import-file-input" accept=".json" multiple>
                    
                    <div class="import-preview" id="import-preview"></div>
                    <button class="import-all-btn" id="import-all-btn">导入全部角色</button>
                </div>

                <div class="import-section">
                    <div class="import-title">
                        <svg class="icon-svg" viewBox="0 0 24 24" style="width:20px;height:20px;">
                            <rect x="3" y="3" width="18" height="18" rx="2"></rect>
                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                            <polyline points="21 15 16 10 5 21"></polyline>
                        </svg>
                        从图片导入角色卡
                    </div>
                    <div class="import-desc">
                        支持导入含有角色卡信息的图片（如SillyTavern头像卡），可自动识别或手动配置角色信息。
                    </div>
                    <div class="import-btn" id="import-image-btn">
                        <svg class="icon-svg" viewBox="0 0 24 24" style="width:20px;height:20px;">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                        点击选择图片
                    </div>
                    <input type="file" class="import-file-input" id="import-image-input" accept="image/*" multiple>
                </div>
                
                <div class="import-section">
                    <div class="import-title">
                        <svg class="icon-svg" viewBox="0 0 24 24" style="width:20px;height:20px;">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="16" x2="12" y2="12"></line>
                            <line x1="12" y1="8" x2="12.01" y2="8"></line>
                        </svg>
                        角色卡格式说明
                    </div>
                    <div class="import-desc">
                        支持的JSON格式：<br>
                        • SillyTavern V2 格式 (spec: chara_card_v2)<br>
                        • SillyTavern V1 格式<br>
                        • 简单格式 {name, description, first_mes}<br><br>
                        必需字段：name（角色名称）<br>
                        可选字段：description, personality, first_mes, avatar, scenario, mes_example
                    </div>
                </div>
            </div>
        </div>

        <!-- 子页面 - 朋友圈 -->
        <div class="sub-page" id="moments-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="moments-page">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">朋友圈</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【朋友圈功能开发中】
                </div>
            </div>
        </div>

        <!-- 子页面 - 论坛 -->
        <div class="sub-page" id="forum-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="forum-page">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">论坛</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【论坛功能开发中】
                </div>
            </div>
        </div>

                <!-- 子页面 - 阅读 -->
        <div class="sub-page" id="reading-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="reading-page">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">阅读</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【阅读功能开发中】
                </div>
            </div>
        </div>

        <!-- 子页面 - 日历 -->
        <div class="sub-page" id="calendar-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="calendar-page">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">日历</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【日历功能开发中】
                </div>
            </div>
        </div>

        <!-- 天气页面 -->
<div class="sub-page" id="weather-page">
    <div class="sub-nav">
        <div class="back-btn" data-back="weather-page">
            <div class="back-arrow"></div>
            <span>返回</span>
        </div>
        <div class="sub-title">天气</div>
    </div>
    <div class="sub-content">
        <div class="placeholder-text">
            【天气功能开发中】
        </div>
    </div>
</div>


        <!-- 购物页面 -->
<div class="sub-page" id="shopping-page">
    <div class="sub-nav">
        <div class="back-btn" data-back="shopping-page">
            <div class="back-arrow"></div>
            <span>返回</span>
        </div>
        <div class="sub-title">购物</div>
    </div>
    <div class="sub-content">
        <div class="placeholder-text">
            【购物功能开发中】
        </div>
    </div>
</div>

        <!-- 子页面 - 游戏中心 -->
        <div class="sub-page" id="game-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="game-page">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">游戏中心</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    【游戏中心开发中】
                </div>
            </div>
        </div>

        <!-- 子页面 - 默契大挑战 -->
        <div class="sub-page" id="tacit-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="tacit-page">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">默契大挑战</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    等待开发中
                </div>
            </div>
        </div>

        <!-- 子页面 - 心灵星系 -->
        <div class="sub-page" id="spirit-galaxy-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="spirit-galaxy-page">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">心灵星系</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    等待开发中
                </div>
            </div>
        </div>

        <!-- 子页面 - 灵感库 -->
        <div class="sub-page" id="idea-library-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="idea-library-page">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">灵感库</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    等待开发中
                </div>
            </div>
        </div>

        <!-- 子页面 - 观察者 -->
        <div class="sub-page" id="third-party-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="third-party-page">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">观察者</div>
            </div>
            <div class="sub-content">
                <div class="placeholder-text">
                    等待开发中
                </div>
            </div>
        </div>

        <!-- 子页面 - API设置 -->
        <div class="sub-page" id="api-settings-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="api-settings-page">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">API设置</div>
            </div>
            <div class="sub-content" style="padding: 0; background-color: #fff; overflow-y: auto; max-height: 100%;">
                <div class="api-settings-container" style="padding:16px;">
                    <!-- 主API设置 -->
                    <div style="margin-bottom:24px;padding-bottom:20px;border-bottom:2px solid #f0f0f0;">
                        <h3 style="margin:0 0 16px 0;font-size:16px;color:#333;font-weight:600;">主API设置</h3>
                        
                        <div class="setting-row">
                            <label class="setting-label">API 端点 (Endpoint)</label>
                            <input id="api-endpoint" class="setting-input" placeholder="例如 https://api.openai.com 或 自建代理端点">
                        </div>

                        <div class="setting-row">
                            <label class="setting-label">API 密钥 (Key)</label>
                            <div style="display:flex;gap:8px;align-items:center;">
                                <input id="api-key" class="setting-input" type="password" placeholder="在此处填写 Bearer Key（可选）" style="flex:1;">
                                <button id="api-key-toggle" class="small-btn" style="flex-shrink:0;padding:6px 12px;height:36px;">显示</button>
                            </div>
                        </div>

                        <div class="setting-row">
                            <label class="setting-label">拉取模型</label>
                            <button id="pull-models-btn" class="small-btn">拉取模型</button>
                        </div>

                        <div class="setting-row">
                            <label class="setting-label">模型名称</label>
                            <select id="models-select" class="models-select" style="height:44px;margin-top:8px;"></select>
                            <div style="margin-top:8px;color:#666;font-size:13px;">目前保存的模型：<span id="selected-model-display">未选择</span></div>
                        </div>
                    </div>
                    


                    <!-- 其他设置 -->
                    <div style="margin-bottom:24px;padding-bottom:20px;border-bottom:2px solid #f0f0f0;">
                        <h3 style="margin:0 0 16px 0;font-size:16px;color:#333;font-weight:600;\">其他设置</h3>
                        
                        <div class="setting-row">
                            <label class="setting-label">AI 时间感知</label>
                            <div style="display:flex;align-items:center;gap:10px;">
                                <input type="checkbox" id="ai-time-aware">
                                <div style="color:#666;font-size:13px;">开启后会将当前时间信息作为 system 指令发送</div>
                            </div>
                        </div>

                        <div class="setting-row">
                            <label class="setting-label">API 上下文条数</label>
                            <div style="display:flex;gap:8px;align-items:center;">
                                <input id="context-lines-input" type="number" placeholder="200" value="200" min="1" max="10000" style="width:100px;padding:8px;border:1px solid #ddd;border-radius:4px;font-size:13px;">
                                <div style="color:#666;font-size:13px;">条消息作为上下文（默认200）</div>
                            </div>
                        </div>
                    </div>

                    <div class="setting-row" style="margin-top:24px;border-top:1px solid #f0f0f0;padding-top:16px;">
                        <label class="setting-label">API 预设管理</label>
                        <button id="api-preset-btn" class="small-btn" style="width:100%;">预设管理</button>
                    </div>

                    <div class="setting-row" style="margin-top:16px;border-top:1px solid #f0f0f0;padding-top:16px;">
                        <label class="setting-label">提示词管理</label>
                        <div style="display:flex;gap:8px;margin-top:8px;">
                            <button id="add-prompt-btn" class="small-btn">新增提示词</button>
                            <button id="prompt-list-btn" class="small-btn">查看提示词列表</button>
                        </div>
                    </div>

                    <div class="setting-row">
                        <label class="setting-label">当前提示词</label>
                        <select id="prompts-select" class="models-select" style="margin-top:8px;"></select>
                        <div id="current-prompt-display" style="margin-top:8px;padding:8px;background:#f9f9f9;border-radius:4px;max-height:150px;overflow-y:auto;white-space:pre-wrap;word-wrap:break-word;font-size:12px;color:#666;font-family:monospace;"></div>
                    </div>

                    <div class="setting-row" style="margin-top:18px;">
                        <button id="save-settings-btn" class="primary-btn">保存设置</button>
                    </div>

                    <div style="margin-top:12px;color:#888;font-size:13px;">
                        使用说明：填写端点与（可选）密钥，点击“拉取模型”获取模型列表。双击顶部用户头像或聊天头像即可将当前会话内容发送到所选模型并获取回复。
                    </div>
                </div>
            </div>
        </div>

        <!-- 子页面 - 情侣空间 -->
        <div class="sub-page" id="couples-space-page">
            <div class="sub-nav">
                <div class="back-btn" id="couples-space-back-btn">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">情侣空间</div>
            </div>
            <div class="sub-content" style="padding: 16px; background-color: #f5f5f5;overflow-y:auto;">
                <div id="couples-space-content" style="background: #fff; border-radius: 8px; padding: 40px 20px; text-align: center;">
                    <div style="color:#999;font-size:16px;">功能开发中...</div>
                </div>
            </div>
        </div>

        <!-- 子页面 - 世界书 -->
        <div class="sub-page" id="worldbook-page">
            <div class="sub-nav">
                <div class="back-btn" data-back="worldbook-page">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">世界书</div>
            </div>
            <div class="sub-content" style="padding: 16px; background-color: #fff;">
                <div style="display:flex;gap:8px;margin-bottom:16px;">
                    <button id="worldbook-add-btn" style="flex:1;padding:10px;background:#000;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:13px;font-weight:500;">新增世界书</button>
                    <button id="worldbook-import-btn" style="flex:1;padding:10px;border:1px solid #ddd;background:#fff;color:#000;border-radius:4px;cursor:pointer;font-size:13px;font-weight:500;">导入世界书</button>
                    <input type="file" id="worldbook-import-input" accept=".json" multiple style="display:none;">
                </div>
                
                <!-- 全局世界书 -->
                <div style="margin-bottom:20px;">
                    <div style="font-weight:600;color:#333;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid #e8e8e8;">全局世界书</div>
                    <div id="global-worldbooks-list" style="display:flex;flex-direction:column;gap:8px;">
                        <div style="text-align:center;color:#999;padding:20px;background:#f9f9f9;border-radius:4px;font-size:13px;">暂无全局世界书</div>
                    </div>
                </div>
                
                <!-- 局部世界书 -->
                <div>
                    <div style="font-weight:600;color:#333;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid #e8e8e8;">局部世界书（需绑定到角色）</div>
                    <div id="local-worldbooks-list" style="display:flex;flex-direction:column;gap:8px;">
                        <div style="text-align:center;color:#999;padding:20px;background:#f9f9f9;border-radius:4px;font-size:13px;">暂无局部世界书</div>
                    </div>
                </div>
            </div>

        </div>

        <!-- 聊天页面 -->
        <div class="chat-page" id="chat-page">
            <div class="chat-nav">
                <div class="back-btn" id="chat-back-btn">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="chat-title-area" style="flex:1;position:relative;display:flex;align-items:center;justify-content:center;">
                    <div class="chat-title" id="chat-title">AI小助手</div>
                    <div class="chat-typing-status" id="chat-typing-status" style="font-size:13px;color:#999;display:none;white-space:nowrap;">正在打字中...</div>
                </div>
                <div class="chat-toolbar-buttons" style="display:flex;gap:0;align-items:center;">
                    <button id="chat-mind-btn" style="width:40px;height:40px;border:none;background:none;cursor:pointer;padding:0;display:flex;align-items:center;justify-content:center;font-size:20px;">
                        🖤
                    </button>
                    <div class="chat-more">
                        <div class="chat-more-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="chat-messages" id="chat-messages"></div>
            
            <div class="quote-message-bar-container" id="quote-message-bar-container" style="display:none;background:#f5f5f5;border-bottom:1px solid #e0e0e0;">
                <div class="quote-message-bar" id="quote-message-bar" style="padding:8px 12px;display:flex;align-items:center;gap:8px;min-height:40px;max-height:60px;overflow-y:auto;">
                    <div class="quote-content" id="quote-content" style="flex:1;font-size:12px;color:#666;word-break:break-word;line-height:1.4;"></div>
                    <button class="quote-cancel-btn" id="quote-cancel-btn" style="border:none;background:none;cursor:pointer;font-size:20px;color:#999;flex-shrink:0;padding:0;min-width:24px;height:24px;display:flex;align-items:center;justify-content:center;">×</button>
                </div>
            </div>

            <div class="chat-toolbar" id="chat-toolbar">
                <button class="tb-btn" id="btn-retry" title="重回">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36M20.49 15a9 9 0 0 1-14.85 3.36"></path></svg>
                </button>
                <button class="tb-btn" id="btn-emoji" title="表情包">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><circle cx="12" cy="12" r="10"></circle><path d="M8 14s1.5 2 4 2 4-2 4-2"></path><circle cx="9" cy="9" r="1"></circle><circle cx="15" cy="9" r="1"></circle></svg>
                </button>
                <button class="tb-btn" id="btn-voice-msg" title="语音条">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><path d="M12 1a4 4 0 0 0-4 4v7a4 4 0 0 0 8 0V5a4 4 0 0 0-4-4z"></path><path d="M8 19a6 6 0 0 0 8 0"></path><line x1="12" y1="19" x2="12" y2="23"></line></svg>
                </button>
                <button class="tb-btn" id="btn-camera" title="拍照">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><path d="M23 19V5a2 2 0 0 0-2-2H3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2z"></path><circle cx="12" cy="13" r="4"></circle></svg>
                </button>
                <button class="tb-btn" id="btn-photo" title="照片">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
                </button>
                <button class="tb-btn" id="btn-location" title="地理位置">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                </button>
                <button class="tb-btn" id="btn-voicecall" title="语音通话">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
                </button>
                <button class="tb-btn" id="btn-videocall" title="视频通话">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><polygon points="23 7 16 12 23 17 23 7"></polygon><rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect></svg>
                </button>
                <button class="tb-btn" id="btn-offline" title="线下功能">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><polyline points="12 5 12 19"></polyline><polyline points="19 12 12 19 5 12"></polyline></svg>
                </button>
                <button class="tb-btn" id="btn-takeout" title="点外卖">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
                </button>
                <button class="tb-btn" id="btn-transfer" title="转账">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><circle cx="12" cy="12" r="8"></circle><path d="M12 7v10M10 8c-1 0-2 1-2 2s1 2 2 2h4c1 0 2 1 2 2s-1 2-2 2M14 16c1 0 2-1 2-2"></path></svg>
                </button>
                <button class="tb-btn" id="btn-listen" title="一起听">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><path d="M5 10c0-3 2-5 4-5s3 1 3 4"></path><path d="M19 10c0-3-2-5-4-5s-3 1-3 4"></path><circle cx="6" cy="14" r="2.5"></circle><circle cx="18" cy="14" r="2.5"></circle><path d="M12 9v4M12 13l-1 5c0 1-1 2-2 2M12 13l1 5c0 1 1 2 2 2"></path></svg>
                </button>
                <button class="tb-btn" id="btn-phone" title="查手机">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><rect x="5" y="2" width="14" height="20" rx="2.5" ry="2.5"></rect><path d="M12 21h0"></path></svg>
                </button>
                <button class="tb-btn" id="btn-frog" title="旅行青蛙">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><ellipse cx="12" cy="12" rx="8" ry="6"></ellipse><circle cx="7" cy="10" r="1.5" fill="#666"></circle><circle cx="17" cy="10" r="1.5" fill="#666"></circle><path d="M9 16c3 1 6 1 6 0"></path><path d="M4 8l-2-1M20 8l2-1"></path></svg>
                </button>
                <button class="tb-btn" id="btn-anonymous" title="匿名提问">
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><rect x="3" y="3" width="18" height="18" rx="2"></rect><line x1="9" y1="9" x2="15" y2="9"></line><line x1="9" y1="13" x2="15" y2="13"></line><line x1="9" y1="17" x2="13" y2="17"></line></svg>
                </button>
                <input type="file" id="toolbar-file-input" accept="image/*" style="display:none">
            </div>

            <div class="chat-input-area">
                <textarea class="chat-input" id="chat-input" placeholder="输入消息..." rows="1"></textarea>
                <button class="chat-send-btn" id="chat-send-btn">
                    <svg viewBox="0 0 24 24">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                </button>
            </div>

            <div class="emoji-library" id="emoji-library" style="display:none;">
                <div class="emoji-lib-header">
                    <button class="emoji-lib-btn" id="emoji-add-btn" title="导入文件">
                        <svg viewBox="0 0 24 24" style="width:16px;height:16px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                    </button>
                    <button class="emoji-lib-btn" id="emoji-add-url-btn" title="导入URL">
                        <svg viewBox="0 0 24 24" style="width:16px;height:16px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg>
                    </button>
                    <button class="emoji-lib-btn" id="emoji-del-btn" title="多选表情包">
                        <svg viewBox="0 0 24 24" style="width:16px;height:16px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><path d="M9 11l3 3L22 4"></path><path d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </button>
                    <button class="emoji-lib-btn" id="emoji-trash-btn" title="删除选中表情包" style="display:none;">
                        <svg viewBox="0 0 24 24" style="width:16px;height:16px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                    </button>
                    <div class="emoji-groups-bar" id="emoji-groups-bar" style="display:none;"></div>
                    <button class="emoji-lib-btn" id="emoji-group-btn" title="分组管理">
                        <svg viewBox="0 0 24 24" style="width:16px;height:16px;stroke:#666;stroke-width:1.8;fill:none;stroke-linecap:round;stroke-linejoin:round;"><circle cx="6" cy="6" r="2"></circle><circle cx="18" cy="6" r="2"></circle><circle cx="6" cy="18" r="2"></circle><circle cx="18" cy="18" r="2"></circle><line x1="8" y1="6" x2="16" y2="6"></line><line x1="8" y1="18" x2="16" y2="18"></line><line x1="6" y1="8" x2="6" y2="16"></line><line x1="18" y1="8" x2="18" y2="16"></line></svg>
                    </button>
                </div>
                <div class="emoji-grid" id="emoji-grid"></div>
                <input type="file" id="emoji-upload-input" accept="image/*,.json" multiple style="display:none">
            </div>

        </div>

        <!-- 个性名片编辑页面 -->
        <div class="card-edit-page" id="card-edit-page">
            <div class="sub-nav">
                <div class="back-btn" id="card-edit-back-btn">
                    <div class="back-arrow"></div>
                    <span>返回</span>
                </div>
                <div class="sub-title">编辑资料</div>
            </div>
            
            <div class="card-edit-preview" id="card-edit-preview">
                <div class="card-edit-preview-avatar" id="card-edit-preview-avatar">薯</div>
                <div class="card-edit-preview-name" id="card-edit-preview-name">薯片机用户</div>
                <div class="card-edit-preview-sig" id="card-edit-preview-sig">这个人很懒，什么都没写~</div>
            </div>
            
            <div class="edit-list">
                <div class="edit-section">
                    <div class="edit-item" id="edit-avatar-btn">
                        <div class="edit-label">头像</div>
                        <div class="edit-value">
                            <div class="edit-avatar-small" id="edit-avatar-small"></div>
                            <div class="edit-arrow"></div>
                        </div>
                    </div>
                    
                    <div class="edit-item" id="edit-bg-btn">
                        <div class="edit-label">背景图</div>
                        <div class="edit-value">
                            <span id="edit-bg-value">默认</span>
                            <div class="edit-arrow"></div>
                        </div>
                    </div>
                    
                    <div class="edit-item" id="edit-name-btn">
                        <div class="edit-label">昵称</div>
                        <div class="edit-value">
                            <span id="edit-name-value">薯片机用户</span>
                            <div class="edit-arrow"></div>
                        </div>
                    </div>
                    
                    <div class="edit-item" id="edit-signature-btn">
                        <div class="edit-label">个性签名</div>
                        <div class="edit-value">
                            <span id="edit-signature-value">这个人很懒，什么都没写~</span>
                            <div class="edit-arrow"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 图片选择弹窗 -->
        <div class="image-picker-modal" id="image-picker-modal">
            <div class="image-picker-content">
                <div class="picker-title" id="picker-title">选择图片</div>
                
                <div class="picker-option" id="picker-local">
                    <div class="picker-option-icon">
                        <svg class="icon-svg" viewBox="0 0 24 24" style="width:24px;height:24px;">
                            <rect x="3" y="3" width="18" height="18" rx="2"></rect>
                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                            <path d="M21 15l-5-5L5 21"></path>
                        </svg>
                    </div>
                    <div class="picker-option-text">从本地相册选择</div>
                </div>
                
                <div class="picker-option" id="picker-url-toggle">
                    <div class="picker-option-icon">
                        <svg class="icon-svg" viewBox="0 0 24 24" style="width:24px;height:24px;">
                            <path d="M10 13a5 5 0 0 0 7.54.54l3 -3 3-3 3"></path>
                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                        </svg>
                    </div>
                    <div class="picker-option-text">输入图片URL</div>
                </div>
                
                <input type="text" class="picker-url-input hidden" id="picker-url-input" placeholder="请输入图片URL地址">
                <button class="picker-url-confirm hidden" id="picker-url-confirm">确认</button>
                
                <input type="file" id="picker-file-input" accept="image/*,.jpg,.jpeg,.png,.gif,.webp" style="display:none;">
                
                <button class="picker-cancel" id="picker-cancel">取消</button>
            </div>
        </div>

        <!-- 更多功能设置弹窗 -->
        <div class="more-settings-modal" id="more-settings-modal">
            <div class="more-settings-content">
                <div class="more-settings-header">
                    <div class="more-settings-title">动态页面设置</div>
                    <div class="more-settings-desc">选择要在动态页面显示的功能</div>
                </div>
                
                <div class="more-settings-list" id="more-settings-list">
                    <div class="more-settings-item" data-func-id="moments">
                        <div class="more-settings-item-left">
                            <div class="more-settings-item-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <rect x="3" y="3" width="18" height="18" rx="2"></rect>
                                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                    <path d="M21 15l-5-5L5 21"></path>
                                </svg>
                            </div>
                            <div class="more-settings-item-name">朋友圈</div>
                        </div>
                        <div class="toggle-switch active" data-func-id="moments"></div>
                    </div>
                    
                <div class="more-settings-item" data-func-id="forum">
                        <div class="more-settings-item-left">
                            <div class="more-settings-item-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                                    <line x1="8" y1="8" x2="16" y2="8"></line>
                                    <line x1="8" y1="12" x2="14" y2="12"></line>
                                </svg>
                            </div>
                            <div class="more-settings-item-name">论坛</div>
                        </div>
                        <div class="toggle-switch active" data-func-id="forum"></div>
                    </div>

                <div class="more-settings-item" data-func-id="reading">
                    <div class="more-settings-item-left">
                        <div class="more-settings-item-icon">
                            <svg class="icon-svg" viewBox="0 0 24 24">
                                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                                <line x1="8" y1="7" x2="16" y2="7"></line>
                                <line x1="8" y1="11" x2="14" y2="11"></line>
                            </svg>
                        </div>
                        <div class="more-settings-item-name">阅读</div>
                    </div>
                    <div class="toggle-switch active" data-func-id="reading"></div>
                </div>

                    <div class="more-settings-item" data-func-id="calendar">
                        <div class="more-settings-item-left">
                            <div class="more-settings-item-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <rect x="3" y="4" width="18" height="18" rx="2"></rect>
                                    <line x1="16" y1="2" x2="16" y2="6"></line>
                                    <line x1="8" y1="2" x2="8" y2="6"></line>
                                    <line x1="3" y1="10" x2="21" y2="10"></line>
                                </svg>
                            </div>
                            <div class="more-settings-item-name">日历</div>
                        </div>
                        <div class="toggle-switch active" data-func-id="calendar"></div>
                    </div>
                    
                    <div class="more-settings-item" data-func-id="weather">
                        <div class="more-settings-item-left">
                            <div class="more-settings-item-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <rect x="3" y="4" width="18" height="18" rx="2"></rect>
                                    <line x1="16" y1="2" x2="16" y2="6"></line>
                                    <line x1="8" y1="2" x2="8" y2="6"></line>
                                    <line x1="3" y1="10" x2="21" y2="10"></line>
                                </svg>
                            </div>
                            <div class="more-settings-item-name">天气</div>
                        </div>
                        <div class="toggle-switch active" data-func-id="weather"></div>
                     </div>

                    <div class="more-settings-item" data-func-id="shopping">
                        <div class="more-settings-item-left">
                            <div class="more-settings-item-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <rect x="3" y="4" width="18" height="18" rx="2"></rect>
                                    <line x1="16" y1="2" x2="16" y2="6"></line>
                                    <line x1="8" y1="2" x2="8" y2="6"></line>
                                    <line x1="3" y1="10" x2="21" y2="10"></line>
                                </svg>
                            </div>
                            <div class="more-settings-item-name">购物</div>
                        </div>
                        <div class="toggle-switch active" data-func-id="shopping"></div>
                    </div>
                    
                    <div class="more-settings-item" data-func-id="game">
                        <div class="more-settings-item-left">
                            <div class="more-settings-item-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <rect x="2" y="6" width="20" height="12" rx="2"></rect>
                                    <circle cx="6" cy="12" r="1.5"></circle>
                                    <circle cx="10" cy="12" r="1.5"></circle>
                                    <path d="M15 10v4"></path>
                                    <path d="M13 12h4"></path>
                                </svg>
                            </div>
                            <div class="more-settings-item-name">游戏中心</div>
                        </div>
                        <div class="toggle-switch active" data-func-id="game"></div>
                    </div>

                    <div class="more-settings-item" data-func-id="tacit">
                        <div class="more-settings-item-left">
                            <div class="more-settings-item-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                                </svg>
                            </div>
                            <div class="more-settings-item-name">默契大挑战</div>
                        </div>
                        <div class="toggle-switch active" data-func-id="tacit"></div>
                    </div>

                    <div class="more-settings-item" data-func-id="spiritGalaxy">
                        <div class="more-settings-item-left">
                            <div class="more-settings-item-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <polygon points="12 2 15.09 10.26 23.77 10.26 17.39 16.01 20.48 24.27 12 18.46 3.52 24.27 6.61 16.01 0.23 10.26 8.91 10.26"></polygon>
                                </svg>
                            </div>
                            <div class="more-settings-item-name">心灵星系</div>
                        </div>
                        <div class="toggle-switch active" data-func-id="spiritGalaxy"></div>
                    </div>

                    <div class="more-settings-item" data-func-id="ideaLibrary">
                        <div class="more-settings-item-left">
                            <div class="more-settings-item-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8.5 8.5z"></path>
                                    <line x1="12" y1="7" x2="12" y2="13"></line>
                                    <line x1="9" y1="10" x2="15" y2="10"></line>
                                </svg>
                            </div>
                            <div class="more-settings-item-name">灵感库</div>
                        </div>
                        <div class="toggle-switch active" data-func-id="ideaLibrary"></div>
                    </div>

                    <div class="more-settings-item" data-func-id="thirdParty">
                        <div class="more-settings-item-left">
                            <div class="more-settings-item-icon">
                                <svg class="icon-svg" viewBox="0 0 24 24">
                                    <circle cx="12" cy="12" r="3"></circle>
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                </svg>
                            </div>
                            <div class="more-settings-item-name">观察者</div>
                        </div>
                        <div class="toggle-switch active" data-func-id="thirdParty"></div>
                    </div>
                
                <div class="more-settings-footer">
                    <button class="more-settings-confirm" id="more-settings-confirm">确定</button>
                </div>
            </div>
        </div>

    </div>


</body>
</html>